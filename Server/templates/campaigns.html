{% extends "layout.html" %}
{% block content %}
    <h1>Управление кампаниями</h1>
    
    <h2>Добавить новую кампанию</h2>
    <form method="post">
        <label for="name">Имя кампании (например, MR_Test_1)</label>
        <input type="text" id="name" name="name" required>
        
        <label for="cost_per_message">Стоимость сообщения</label>
        <input type="number" step="0.01" id="cost_per_message" name="cost_per_message" required>
        
        <label for="cost_per_invite">Стоимость инвайта</label>
        <input type="number" step="0.01" id="cost_per_invite" name="cost_per_invite" required>
        
        <label for="message_type">Тип сообщения</label>
        <select id="message_type" name="message_type">
            <option value="text_button">текст+кнопка</option>
            <option value="image_text_button">картинка+текст+кнопка</option>
            <option value="image_button">картинка+кнопка</option>
            <option value="video_text_button">видео+текст+кнопка</option>
            <option value="video_button">видео+кнопка</option>
            <option value="audio_text_button">аудио+текст+кнопка</option>
            <option value="audio_button">аудио+кнопка</option>
            <option value="image">картинка</option>
        </select>
        
        <label for="base_type">База</label>
        <select id="base_type" name="base_type">
            <option value="usernames">юзернеймы</option>
            <option value="phones">телефоны</option>
            <option value="usernames_phones">юзернеймы+телефоны</option>
        </select>
        
        <label for="link_type">Тип ссылки</label>
        <select id="link_type" name="link_type">
            <option value="direct_pm">прямая личка</option>
            <option value="direct_external">прямая внешняя</option>
            <option value="direct_bot">прямая бот</option>
            <option value="redirect">редирект</option>
        </select>
        
        <label for="offer">Оффер (введите или выберите)</label>
        <input list="offer_list" id="offer" name="offer">
        <datalist id="offer_list">
            {% for offer in existing_offers %}
            <option value="{{ offer }}">
            {% endfor %}
        </datalist>
        <input type="submit" value="Создать кампанию" class="btn">
    </form>

    <h2>Существующие кампании</h2>

    <form method="get" action="/campaigns" style="margin-top: 15px; margin-bottom: 15px; display: flex; gap: 10px;">
        <input type="text" name="search" placeholder="Поиск по имени..." value="{{ search_query or '' }}" style="width: 300px; margin: 0;">
        <input type="submit" value="Поиск" class="btn" style="width: auto; margin: 0;">
        <a href="/campaigns" class="btn" style="background-color: #6c757d; width: auto; margin: 0;">Сбросить</a>
    </form>
    <table style="font-size: 0.9em;">
        <thead>
            <tr>
                <th>ID</th>
                <th>Имя</th>
                <th>Дата</th>
                <th>Цена C/I</th>
                <th>Тип сообщ.</th>
                <th>База</th>
                <th>Ссылка</th>
                <th>Оффер</th>
                <th>Действия</th> </tr>
        </thead>
        <tbody>
            {% for campaign in campaigns %}
            <tr>
                <td>{{ campaign.id }}</td>
                <td>{{ campaign.name }}</td>
                <td>{{ campaign.campaign_date }}</td>
                <td>{{ campaign.cost_per_message }} / {{ campaign.cost_per_invite }}</td>
                <td>{{ campaign.message_type }}</td>
                <td>{{ campaign.base_type }}</td>
                <td>{{ campaign.link_type }}</td>
                <td>{{ campaign.offer }}</td>
                <td>
                    <a href="{{ url_for('edit_campaign', campaign_id=campaign.id) }}" class="btn" style="padding: 5px 8px; background-color: #ffc107;">Edit</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}